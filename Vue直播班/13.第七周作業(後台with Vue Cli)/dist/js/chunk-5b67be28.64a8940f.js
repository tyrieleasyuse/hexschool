(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b67be28"],{5651:function(t,e,c){"use strict";c.r(e);var r=c("7a23"),n={class:"text-end mt-4"},a={class:"table mt-4"},l=Object(r["h"])("thead",null,[Object(r["h"])("tr",null,[Object(r["h"])("th",null,"購買時間"),Object(r["h"])("th",null,"Email"),Object(r["h"])("th",null,"購買款項"),Object(r["h"])("th",null,"應付金額"),Object(r["h"])("th",null,"是否付款"),Object(r["h"])("th",null,"編輯")])],-1),o=Object(r["h"])("br",null,null,-1),i={class:"list-unstyled"},d={class:"text-right"},s={class:"form-check form-switch"},b={key:0},u={key:1},O={class:"btn-group"};function h(t,e,c,h,j,p){var m=Object(r["y"])("Loading"),g=Object(r["y"])("OrderModal"),f=Object(r["y"])("pagination"),v=Object(r["y"])("DelModal");return Object(r["r"])(),Object(r["e"])("div",null,[Object(r["h"])(m,{active:j.isLoading,"z-index":1060},null,8,["active"]),Object(r["h"])("div",n,[Object(r["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=function(t){return p.deleteAllOrder()})}," 清空訂單 ")]),Object(r["h"])("table",a,[l,Object(r["h"])("tbody",null,[(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["w"])(j.orders,(function(t,e){return Object(r["r"])(),Object(r["e"])("tr",{key:t.id,class:["bg-product-hightlight",{"bg-product-grey":e%2===0}]},[Object(r["h"])("td",null,[Object(r["g"])(Object(r["B"])(p.getDate(t.create_at)),1),o,Object(r["g"])(Object(r["B"])(p.getTime(t.create_at)),1)]),Object(r["h"])("td",null,Object(r["B"])(t.user.email),1),Object(r["h"])("td",null,[Object(r["h"])("ul",i,[(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["w"])(t.products,(function(t){return Object(r["r"])(),Object(r["e"])("li",{key:t.product_id},Object(r["B"])(t.product.title)+" 數量："+Object(r["B"])(t.qty)+" "+Object(r["B"])(t.product.unit),1)})),128))])]),Object(r["h"])("td",d,Object(r["B"])(t.total),1),Object(r["h"])("td",null,[Object(r["h"])("div",s,[Object(r["I"])(Object(r["h"])("input",{class:"form-check-input",type:"checkbox",id:"paidSwitch".concat(t.id),onChange:function(e){return p.paidUpdateStatus(t)},"onUpdate:modelValue":function(e){return t.is_paid=e}},null,40,["id","onChange","onUpdate:modelValue"]),[[r["D"],t.is_paid]]),Object(r["h"])("label",{class:"form-check-label",for:"paidSwitch".concat(t.id)},[t.is_paid?(Object(r["r"])(),Object(r["e"])("span",b,"已付款")):(Object(r["r"])(),Object(r["e"])("span",u,"未付款"))],8,["for"])])]),Object(r["h"])("td",null,[Object(r["h"])("div",O,[Object(r["h"])("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:function(e){return p.editOrderItemDialog(t)}},"檢視",8,["onClick"]),Object(r["h"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return p.deleteOrderItemDialog(t)}},"刪除",8,["onClick"])])])],2)})),128))])]),Object(r["h"])(g,{order:j.tempOrder,ref:"ordModal",onEmitUpdate:p.getOrderList},null,8,["order","onEmitUpdate"]),Object(r["h"])(f,{item:j.pagination,onEmitNavigate:p.getOrderList},null,8,["item","onEmitNavigate"]),Object(r["h"])(v,{item:j.tempOrder,ref:"delModal",onEmitUpdate:p.getOrderList},null,8,["item","onEmitUpdate"])])}c("99af"),c("b0c0");var j={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},p={class:"modal-dialog modal-xl",role:"document"},m={class:"modal-content border-0"},g=Object(r["h"])("div",{class:"modal-header bg-dark text-white"},[Object(r["h"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(r["h"])("span",null,"訂單細節")]),Object(r["h"])("button",{type:"button",class:"btn-close bg-product-hightlight bg-product-grey","data-bs-dismiss":"modal","aria-label":"Close"})],-1),f={class:"modal-body"},v={class:"row"},y={class:"col-md-4"},k=Object(r["h"])("h3",null,"用戶資料",-1),w={key:0,class:"table"},D=Object(r["h"])("th",{style:{width:"100px"}},"姓名",-1),M=Object(r["h"])("th",null,"Email",-1),x=Object(r["h"])("th",null,"電話",-1),B=Object(r["h"])("th",null,"地址",-1),_={class:"col-md-8"},L=Object(r["h"])("h3",null,"訂單細節",-1),$={class:"table"},S=Object(r["h"])("th",{style:{width:"100px"}},"訂單編號",-1),C=Object(r["h"])("th",null,"下單時間",-1),U=Object(r["h"])("br",null,null,-1),E=Object(r["h"])("th",null,"付款時間",-1),I={key:0},J=Object(r["h"])("br",null,null,-1),N={key:1},T=Object(r["h"])("th",null,"付款狀態",-1),q={key:0,class:"text-success"},F={key:1,class:"text-muted"},V=Object(r["h"])("th",null,"總金額",-1),A=Object(r["h"])("h3",null,"選購商品",-1),H={class:"table"},Y=Object(r["h"])("thead",null,[Object(r["h"])("tr")],-1),z={class:"text-end"},G={class:"d-flex justify-content-end"},K={class:"form-check"},P={class:"form-check-label",for:"flexCheckDefault"},Q={key:0},R={key:1},W={class:"modal-footer"},X=Object(r["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Z(t,e,c,n,a,l){return Object(r["r"])(),Object(r["e"])("div",j,[Object(r["h"])("div",p,[Object(r["h"])("div",m,[g,Object(r["h"])("div",f,[Object(r["h"])("div",v,[Object(r["h"])("div",y,[k,a.tempOrder.user?(Object(r["r"])(),Object(r["e"])("table",w,[Object(r["h"])("tbody",null,[Object(r["h"])("tr",null,[D,Object(r["h"])("td",null,Object(r["B"])(a.tempOrder.user.name),1)]),Object(r["h"])("tr",null,[M,Object(r["h"])("td",null,Object(r["B"])(a.tempOrder.user.email),1)]),Object(r["h"])("tr",null,[x,Object(r["h"])("td",null,Object(r["B"])(a.tempOrder.user.tel),1)]),Object(r["h"])("tr",null,[B,Object(r["h"])("td",null,Object(r["B"])(a.tempOrder.user.address),1)])])])):Object(r["f"])("",!0)]),Object(r["h"])("div",_,[L,Object(r["h"])("table",$,[Object(r["h"])("tbody",null,[Object(r["h"])("tr",null,[S,Object(r["h"])("td",null,Object(r["B"])(a.tempOrder.id),1)]),Object(r["h"])("tr",null,[C,Object(r["h"])("td",null,[Object(r["g"])(Object(r["B"])(l.getDate(a.tempOrder.create_at)),1),U,Object(r["g"])(Object(r["B"])(l.getTime(a.tempOrder.create_at)),1)])]),Object(r["h"])("tr",null,[E,Object(r["h"])("td",null,[a.tempOrder.paid_date?(Object(r["r"])(),Object(r["e"])("span",I,[Object(r["g"])(Object(r["B"])(l.getDate(a.tempOrder.paid_date)),1),J,Object(r["g"])(Object(r["B"])(l.getTime(a.tempOrder.paid_date)),1)])):(Object(r["r"])(),Object(r["e"])("span",N,"時間不正確"))])]),Object(r["h"])("tr",null,[T,Object(r["h"])("td",null,[a.tempOrder.is_paid?(Object(r["r"])(),Object(r["e"])("strong",q,"已付款")):(Object(r["r"])(),Object(r["e"])("span",F,"尚未付款"))])]),Object(r["h"])("tr",null,[V,Object(r["h"])("td",null,Object(r["B"])(a.tempOrder.total),1)])])]),A,Object(r["h"])("table",H,[Y,Object(r["h"])("tbody",null,[(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["w"])(a.tempOrder.products,(function(t){return Object(r["r"])(),Object(r["e"])("tr",{key:t.product_id},[Object(r["h"])("th",null,Object(r["B"])(t.product.title),1),Object(r["h"])("td",null,Object(r["B"])(t.qty)+" / "+Object(r["B"])(t.product.unit),1),Object(r["h"])("td",z,Object(r["B"])(t.final_total),1)])})),128))])]),Object(r["h"])("div",G,[Object(r["h"])("div",K,[Object(r["I"])(Object(r["h"])("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":e[1]||(e[1]=function(t){return a.tempOrder.is_paid=t})},null,512),[[r["D"],a.tempOrder.is_paid]]),Object(r["h"])("label",P,[a.tempOrder.is_paid?(Object(r["r"])(),Object(r["e"])("span",Q,"已付款")):(Object(r["r"])(),Object(r["e"])("span",R,"未付款"))])])])])])]),Object(r["h"])("div",W,[X,Object(r["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=function(t){return l.editOrderItem(a.tempOrder)})}," 修改付款狀態 ")])])])],512)}var tt=c("7c2b"),et=c.n(tt),ct={props:{order:{type:Object,default:function(){return{}}}},data:function(){return{tempOrder:{},orderModal:""}},watch:{order:function(){this.tempOrder=this.order}},methods:{openModal:function(){console.log(this.tempOrder),this.orderModal.show()},closeModal:function(){this.orderModal.hide()},getDate:function(t){var e=1e3*t,c=new Date(e).getFullYear()+"-"+(new Date(e).getMonth()+1)+"-"+new Date(e).getDate();return c},getTime:function(t){var e=1e3*t,c=new Date(e).getHours()+":"+new Date(e).getMinutes()+":"+new Date(e).getSeconds();return c},editOrderItem:function(t){var e=this,c=this.tempOrder.id,r="".concat("https://vue3-course-api.hexschool.io/","api/").concat("hunterchen","/admin/order/").concat(c),n={data:this.tempOrder};this.$http.put(r,n).then((function(t){var c=t.data.success;if(c)e.$emit("emit-update"),e.$toast.success("訂單已更新。"),e.orderModal.hide();else{var r=t.data.message;e.$toast.error(r)}})).catch((function(t){e.$toast.error(t)}))}},mounted:function(){var t=document.querySelector("#orderModal");this.orderModal=new et.a(t)}};c("e814");ct.render=Z;var rt=ct,nt=c("1799"),at=c("6ff1"),lt=c("8a14"),ot=(c("fe26"),{components:{OrderModal:rt,pagination:nt["a"],DelModal:at["a"],Loading:lt["a"]},data:function(){return{orders:[],pagination:{},tempOrder:{},isLoading:!1}},methods:{getOrderList:function(t){var e=this,c=void 0===t?this.pagination.current_page:t,r="".concat("https://vue3-course-api.hexschool.io/","api/").concat("hunterchen","/admin/orders?page=")+c;this.isLoading=!0,this.$http.get(r).then((function(t){var c=t.data.success;if(c)e.orders=t.data.orders,e.pagination=t.data.pagination,e.isLoading=!1;else{var r=t.data.message;e.$toast.error(r),e.$router.push("/"),e.isLoading=!1}})).catch((function(t){e.$toast.error(t),e.isLoading=!1}))},deleteOrderItemDialog:function(t){t.is_order=!0,this.tempOrder=JSON.parse(JSON.stringify(t)),this.$refs.delModal.openModal()},deleteAllOrder:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("hunterchen","/admin/orders/all");this.$http.delete(e).then((function(e){var c=e.data.success;if(c)t.getOrderList(),t.$toast.error("已清空所有訂單。");else{var r=e.data.message;t.$toast.error(r)}})).catch((function(e){t.$toast.error(e)}))},paidUpdateStatus:function(t){var e=this,c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("hunterchen","/admin/order/")+t.id,r={data:{is_paid:t.is_paid}};this.isLoading=!0,this.$http.put(c,r).then((function(t){var c=t.data.success;if(c)e.$toast.error("已更新訂單狀態。"),e.isLoading=!1;else{var r=t.data.message;e.$toast.error(r),e.isLoading=!1}})).catch((function(t){e.$toast.error(t),e.isLoading=!1}))},editOrderItemDialog:function(t){this.tempOrder=JSON.parse(JSON.stringify(t)),this.$refs.ordModal.openModal()},getDate:function(t){var e=1e3*t,c=new Date(e).getFullYear()+"-"+(new Date(e).getMonth()+1)+"-"+new Date(e).getDate();return c},getTime:function(t){var e=1e3*t,c=new Date(e).getHours()+":"+new Date(e).getMinutes()+":"+new Date(e).getSeconds();return c}},mounted:function(){this.getOrderList(1)}});ot.render=h;e["default"]=ot},b0c0:function(t,e,c){var r=c("83ab"),n=c("9bf2").f,a=Function.prototype,l=a.toString,o=/^\s*function ([^ (]*)/,i="name";r&&!(i in a)&&n(a,i,{configurable:!0,get:function(){try{return l.call(this).match(o)[1]}catch(t){return""}}})},e3b6:function(t,e,c){},e814:function(t,e,c){"use strict";c("e3b6")}}]);
//# sourceMappingURL=chunk-5b67be28.64a8940f.js.map